{
  isNixOS ? false,
  ...
}:
let
  # get EDID's with: autorandr --fingerprint
  fingerprint = {
    laptop = if isNixOS
      then "00ffffffffffff0009e5b40c0000000034210104a51d1378070aa5a7554b9f250c505400000001010101010101010101010101010101119140a0b0807470302036001dbe1000001a000000fd001e78f4f44a010a202020202020000000fe00424f45204e4a0a202020202020000000fc004e4531333541314d2d4e59310a023170207902002000139a0e00b40c000000003417074e4531334e593121001d220b6c07400b8007886efa54b8749f56820c023554d05fd05f483512782200144c550b883f0b9f002f001f007f077300020005002500094c550b4c550b1e7880810013721a000003011e7800006a426a427800000000000000000000000000004f907020790000260009020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003690"
      else "FIXME";
    office = "00ffffffffffff0030aed163443242361f210104b54627783e9da5ae5046a2240e5054adef00714f8180818a9500a9c0a9cfb300d1cf4dd000a0f0703e8030203500b9882100001a000000ff0056333042364232440a20202020000000fd00324b1da03c010a202020202020000000fc00503332702d33300a202020202001d2020322f14a01030204901211131f612309070783010000e305c000e60605015a343d023a801871382d40582c4500b9882100001ecc7400a0a0a01e5030203500b9882100001a565e00a0a0a0295030203500b9882100001e00000000000000000000000000000000000000000000000000000000000000000000000000000057";
    home = "00ffffffffffff0010ac794255534d411c220104b53c22783adf15ad5044ad250f5054a54b00d100d1c0b300a94081808100714fe1c04dd000a0f0703e803020350055502100001a000000ff004a4439594733340a2020202020000000fc0044454c4c20553237323351450a000000fd0017560f8c36010a2020202020200108020317f14a101f20041312110302012309070783010000a36600a0f0701f803020350055502100001a565e00a0a0a029503020350055502100001a114400a080001f503020360055502100001abf1600a08038134030203a0055502100001a0000000000000000000000000000000000000000000000000000000000000000a9";
  };
in
{
  enable = !isNixOS;
  profiles = {
    laptop = {
      inherit fingerprint;
      config = {
        laptop = {
          enable = true;
          mode = "2880x1920";
        };
      };
    };
    office = {
      inherit fingerprint;
      config = {
        laptop.enable = true;
        office = {
          enable = true;
          primary = true;
          mode = "3840x2160";
        };
      };
    };
    home = {
      inherit fingerprint;
      config = {
        laptop.enable = false;
        home = {
          enable = true;
          primary = true;
          mode = "3840x2160";
        };
      };
    };
  };
  hooks = {
    postswitch = {
      keyboard-layout = ''
        set -euxo pipefail
        setxkbmap us
        case "$AUTORANDR_CURRENT_PROFILE" in
          office)
            xmodmap $HOME/.Xmodmap_split
            ;;
          laptop)
            xmodmap $HOME/.Xmodmap
            ;;
          *)
            echo "autorandr keyboard-layout: no profile match, keeping current xmodmap"
            ;;
        esac
      '';
    };
  };
}
